<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane prefHeight="800.0" prefWidth="1400.0" 
            styleClass="container" 
            stylesheets="@modern-ui.css" 
            xmlns="http://javafx.com/javafx/17.0.12" 
            xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="controller.ManagePasswords">

    <!-- Top Navigation Bar -->
    <top>
        <HBox styleClass="card" alignment="CENTER_LEFT" spacing="20" padding="16">
            <ImageView fitHeight="32.0" fitWidth="32.0" preserveRatio="true">
                <image>
                    <Image url="@icons_and_images/pos_icon.png" />
                </image>
            </ImageView>
            <Label text="Manage Passwords" styleClass="title-medium" />
            <Region HBox.hgrow="ALWAYS" />
            <Button text="Back" styleClass="btn-outline" onAction="#handleBack" />
        </HBox>
    </top>

    <!-- Main Content -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="scroll-pane">
            <VBox spacing="32" padding="32" maxWidth="1200">
                
                <!-- Header -->
                <VBox spacing="16" alignment="CENTER">
                    <Label text="Manage User Passwords" styleClass="title-large" />
                    <Label text="Update account credentials for staff members" styleClass="body-text" />
                </VBox>

                <!-- Staff Management Cards -->
                <HBox spacing="24" alignment="CENTER">
                    
                    <!-- Cashiers Section -->
                    <VBox styleClass="card" spacing="16" prefWidth="500">
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <ImageView fitHeight="32.0" fitWidth="32.0" preserveRatio="true">
                                <image>
                                    <Image url="@icons_and_images/cashier.jpg" />
                                </image>
                            </ImageView>
                            <Label text="Cashiers" styleClass="title-medium" />
                        </HBox>
                        
                        <ScrollPane fitToWidth="true" styleClass="scroll-pane" VBox.vgrow="ALWAYS">
                            <VBox fx:id="cashierBox" spacing="12" padding="8">
                                <!-- Cashier items will be dynamically added here -->
                                <Label text="No cashiers found" styleClass="body-text" />
                            </VBox>
                        </ScrollPane>
                    </VBox>

                    <!-- Data Entry Operators Section -->
                    <VBox styleClass="card" spacing="16" prefWidth="500">
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <ImageView fitHeight="32.0" fitWidth="32.0" preserveRatio="true">
                                <image>
                                    <Image url="@icons_and_images/images (1).png" />
                                </image>
                            </ImageView>
                            <Label text="Data Entry Operators" styleClass="title-medium" />
                        </HBox>
                        
                        <ScrollPane fitToWidth="true" styleClass="scroll-pane" VBox.vgrow="ALWAYS">
                            <VBox fx:id="operatorBox" spacing="12" padding="8">
                                <!-- Operator items will be dynamically added here -->
                                <Label text="No operators found" styleClass="body-text" />
                            </VBox>
                        </ScrollPane>
                    </VBox>
                </HBox>

                <!-- Quick Actions -->
                <VBox styleClass="card" spacing="16">
                    <Label text="Quick Actions" styleClass="title-small" />
                    <HBox spacing="16" alignment="CENTER">
                        <Button text="Reset All Passwords" styleClass="btn-secondary" onAction="#handleResetAllPasswords" />
                        <Button text="Export User List" styleClass="btn-secondary" onAction="#handleExportUserList" />
                        <Button text="Import Users" styleClass="btn-secondary" onAction="#handleImportUsers" />
                        <Button text="Generate Reports" styleClass="btn-secondary" onAction="#handleGenerateReports" />
                    </HBox>
                </VBox>

                <!-- Statistics -->
                <VBox spacing="16">
                    <Label text="User Statistics" styleClass="title-medium" />
                    <GridPane hgap="16" vgap="16">
                        <columnConstraints>
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="200" prefWidth="200" />
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="200" prefWidth="200" />
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="200" prefWidth="200" />
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="200" prefWidth="200" />
                        </columnConstraints>

                        <!-- Total Users -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8" GridPane.columnIndex="0">
                            <Label text="Total Users" styleClass="caption-text" />
                            <Label text="15" styleClass="title-medium" />
                            <Label text="Active" styleClass="success-text" />
                        </VBox>

                        <!-- Cashiers -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8" GridPane.columnIndex="1">
                            <Label text="Cashiers" styleClass="caption-text" />
                            <Label text="8" styleClass="title-medium" />
                            <Label text="Active" styleClass="primary-text" />
                        </VBox>

                        <!-- Operators -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8" GridPane.columnIndex="2">
                            <Label text="Operators" styleClass="caption-text" />
                            <Label text="7" styleClass="title-medium" />
                            <Label text="Active" styleClass="warning-text" />
                        </VBox>

                        <!-- Password Changes -->
                        <VBox styleClass="card" alignment="CENTER" spacing="8" GridPane.columnIndex="3">
                            <Label text="Password Changes" styleClass="caption-text" />
                            <Label text="3" styleClass="title-medium" />
                            <Label text="This Week" styleClass="success-text" />
                        </VBox>
                    </GridPane>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>

    <!-- Edit Details Overlay -->
    <VBox fx:id="editPane" styleClass="loading-overlay" visible="false" 
           alignment="CENTER" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" 
           AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">
        <VBox styleClass="card" spacing="20" maxWidth="400" alignment="CENTER">
            <Label fx:id="editTitle" text="Edit User Details" styleClass="title-medium" />
            
            <VBox spacing="12" maxWidth="350">
                <VBox spacing="8">
                    <Label text="Username" styleClass="form-label" />
                    <TextField fx:id="usernameField" promptText="Enter username" styleClass="form-field" />
                </VBox>
                
                <VBox spacing="8">
                    <Label text="Full Name" styleClass="form-label" />
                    <TextField fx:id="nameField" promptText="Enter full name" styleClass="form-field" />
                </VBox>
                
                <VBox spacing="8">
                    <Label text="Email" styleClass="form-label" />
                    <TextField fx:id="emailField" promptText="Enter email address" styleClass="form-field" />
                </VBox>
                
                <VBox spacing="8">
                    <Label text="Salary" styleClass="form-label" />
                    <TextField fx:id="salaryField" promptText="Enter salary" styleClass="form-field" />
                </VBox>
                
                <VBox spacing="8">
                    <Label text="New Password" styleClass="form-label" />
                    <PasswordField fx:id="passwordField" promptText="Enter new password" styleClass="form-field" />
                </VBox>
            </VBox>
            
            <HBox spacing="12" alignment="CENTER">
                <Button text="Save Changes" styleClass="btn-primary" onAction="#saveDetails" />
                <Button text="Cancel" styleClass="btn-outline" onAction="#closeEditPane" />
            </HBox>
        </VBox>
    </VBox>

    <!-- Status Bar -->
    <bottom>
        <HBox styleClass="card" alignment="CENTER_LEFT" spacing="16" padding="12">
            <Label text="Status:" styleClass="form-label" />
            <Label text="Ready to manage passwords" styleClass="body-text" />
            <Region HBox.hgrow="ALWAYS" />
            <Label text="Users:" styleClass="caption-text" />
            <Label text="15" styleClass="body-text" />
        </HBox>
    </bottom>
</BorderPane>
